<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
  <meta http-equiv="window-target" content="_top" />
  
  
  <title>idea使用wildfly创建ejb项目 | A Programmer</title>
  <meta name="description" content="准备工作到官网下载wildfy，解压缩即可。 创建EJB端模块 在已有的项目中新建模块（直接新建工程也可以），选择web application和ejb(当时我只选择ejb，发现一直报错找不到war包，部署不上去，勾选了web application就可以部署了，还不知道啥原因)    在src中新建包，我这里是xyz.wyy.order.service,里面新建接口和实现类。（暂时忽略其他包）">
<meta name="keywords" content="java">
<meta property="og:type" content="article">
<meta property="og:title" content="idea使用wildfly创建ejb项目">
<meta property="og:url" content="http://imwyy.github.io/2018/01/05/idea使用wildfly创建ejb项目/index.html">
<meta property="og:site_name" content="stpehac的博客">
<meta property="og:description" content="准备工作到官网下载wildfy，解压缩即可。 创建EJB端模块 在已有的项目中新建模块（直接新建工程也可以），选择web application和ejb(当时我只选择ejb，发现一直报错找不到war包，部署不上去，勾选了web application就可以部署了，还不知道啥原因)    在src中新建包，我这里是xyz.wyy.order.service,里面新建接口和实现类。（暂时忽略其他包）">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/7054861-3072fdcbae1ddd58.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/7054861-0dd53c35b4a3f73f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/7054861-5143929974774016.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/7054861-4700eeacb162cdf0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/7054861-302466015ecf83e2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/7054861-509ac6183935c51c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/7054861-4e940cce92b1d827.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/7054861-509ac6183935c51c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/7054861-401dc860a846391d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:updated_time" content="2018-01-14T08:12:27.361Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="idea使用wildfly创建ejb项目">
<meta name="twitter:description" content="准备工作到官网下载wildfy，解压缩即可。 创建EJB端模块 在已有的项目中新建模块（直接新建工程也可以），选择web application和ejb(当时我只选择ejb，发现一直报错找不到war包，部署不上去，勾选了web application就可以部署了，还不知道啥原因)    在src中新建包，我这里是xyz.wyy.order.service,里面新建接口和实现类。（暂时忽略其他包）">
<meta name="twitter:image" content="http://upload-images.jianshu.io/upload_images/7054861-3072fdcbae1ddd58.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
  <!-- Canonical links -->
  <link rel="canonical" href="http://imwyy.github.io/2018/01/05/idea使用wildfly创建ejb项目/index.html">
  
    <link rel="alternate" href="/atom.xml" title="stpehac的博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/head.jpg" type="image/x-icon">
  
  <!-- font-awesome CSS -->
  <link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css">
  
    
    

</head>


<body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage">
  <header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="https://github.com/IMWYY" target="_blank">
          <img class="img-circle img-rotate" src="/images/head.jpg" width="200" height="200">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">stephen</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md">What The f__k</h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="fa fa-map-marker"></i> Nanjing, China</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="Search" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="fa fa-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="Type something..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
      <!-- <span class="ins-close ins-selectable"><i class="fa fa-times"></i></span> -->
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav">
        
        
        
        <li class="menu-item menu-item-home">
          <a href="/">
            
            <i class="fa fa-fw fa-dashboard"></i>
            
            <span class="menu-title">Home</span>
          </a>
        </li>
        
        
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            
            <i class="fa fa-fw fa-delicious"></i>
            
            <span class="menu-title">Archives</span>
          </a>
        </li>
        
        
        
        <li class="menu-item menu-item-categories active">
          <a href="/categories">
            
            <i class="fa fa-fw fa-folder"></i>
            
            <span class="menu-title">Categories</span>
          </a>
        </li>
        
        
        
        <li class="menu-item menu-item-tags">
          <a href="/tags">
            
            <i class="fa fa-fw fa-tags"></i>
            
            <span class="menu-title">Tags</span>
          </a>
        </li>
        
      </ul>
      
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/IMWYY" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="fa fa-github"></i></a></li>
        
    </ul>

    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">Board</h3>
    <div class="widget-body">
        <div id="board">
            
            <p>您好，您是第<span id="busuanzi_value_site_uv">0</span>位访客</p>
            
            <div class="content">
                
            </div>
        </div>
    </div>
</div>

    
      
  <div class="widget">
    <h3 class="widget-title">Categories</h3>
    <div class="widget-body">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/android/">android</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/">java</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/leetcode/">leetcode</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/shell/">shell</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/小玩意/">小玩意</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/干货/">干货</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据库/">数据库</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/算法/">算法</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/踩坑/">踩坑</a><span class="category-list-count">1</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">Tags</h3>
    <div class="widget-body">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/android/">android</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java-EE/">java EE</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/leetcode/">leetcode</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shell/">shell</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring/">spring</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/安装和配置/">安装和配置</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/小玩意/">小玩意</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/干货/">干货</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据库/">数据库</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据库锁/">数据库锁</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/算法/">算法</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/踩坑/">踩坑</a><span class="tag-list-count">5</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">Archive</h3>
    <div class="widget-body">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a><span class="archive-list-count">16</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget-body">
      <ul class="recent-post-list list-unstyled no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/leetcode/">leetcode</a>
              </p>
              <p class="item-title">
                <a href="/2018/03/13/leetcode之manacher算法/" class="title">leetcode之manacher算法</a>
              </p>
              <p class="item-date">
                <time datetime="2018-03-13T04:17:37.000Z" itemprop="datePublished">2018-03-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/数据库/">数据库</a>
              </p>
              <p class="item-title">
                <a href="/2018/03/08/数据库的锁机制/" class="title">数据库的锁机制</a>
              </p>
              <p class="item-date">
                <time datetime="2018-03-08T10:11:15.000Z" itemprop="datePublished">2018-03-08</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/java/">java</a>
              </p>
              <p class="item-title">
                <a href="/2018/02/09/idea项目添加spring/" class="title">idea项目添加spring</a>
              </p>
              <p class="item-date">
                <time datetime="2018-02-09T03:08:00.000Z" itemprop="datePublished">2018-02-09</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/android/">android</a>
              </p>
              <p class="item-title">
                <a href="/2018/01/26/android引入第三方库导致support版本冲突解决方案/" class="title">android第三方库导致support版本冲突解决方案</a>
              </p>
              <p class="item-date">
                <time datetime="2018-01-26T05:41:24.000Z" itemprop="datePublished">2018-01-26</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/算法/">算法</a>
              </p>
              <p class="item-title">
                <a href="/2018/01/24/动态规划之背包问题及leetcode实例/" class="title">动态规划之01背包问题及leetcode实例</a>
              </p>
              <p class="item-date">
                <time datetime="2018-01-24T05:24:57.000Z" itemprop="datePublished">2018-01-24</time>
              </p>
            </div>
          </li>
          
      </ul>
    </div>
  </div>
  

    
  </div>
</aside>

  
  
<main class="main" role="main">
  <div class="content">
  <article id="post-idea使用wildfly创建ejb项目" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      idea使用wildfly创建ejb项目
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="fa fa-calendar-check-o"></i>
	<a href="/2018/01/05/idea使用wildfly创建ejb项目/" class="article-date">
	  <time datetime="2018-01-05T12:28:34.000Z" itemprop="datePublished">2018-01-05</time>
	</a>
</span>
        
  <span class="article-category">
    <i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/java/">java</a>
  </span>

        
  <span class="article-tag">
    <i class="fa fa-tag"></i>
	<a class="article-tag-link" href="/tags/java/">java</a>
  </span>


        
	<span class="article-read hidden-xs">
	    <i class="fa fa-eye" aria-hidden="true"></i>
	    <span id="busuanzi_container_page_pv">
			<span id="busuanzi_value_page_pv">0</span>
		</span>
	</span>


        <span class="post-comment"><i class="fa fa-commenting-o"></i> <a href="/2018/01/05/idea使用wildfly创建ejb项目/#comments" class="article-comment-link">Comments</a></span>
        
	
		<span class="post-wordcount hidden-xs" itemprop="wordCount">Word Count: 1,648(words)</span>
	
	
		<span class="post-readcount hidden-xs" itemprop="timeRequired">Read Count: 7(minutes)</span>
	

      </div>
      
    </div>
    <div class="article-entry markdown-body" itemprop="articleBody">
      
        <h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><p>到官网下载wildfy，解压缩即可。</p>
<h2 id="创建EJB端模块"><a href="#创建EJB端模块" class="headerlink" title="创建EJB端模块"></a>创建EJB端模块</h2><ol>
<li><p>在已有的项目中新建模块（直接新建工程也可以），选择web application<br>和ejb(当时我只选择ejb，发现一直报错找不到war包，部署不上去，勾选了web application就可以部署了，还不知道啥原因)</p>
<p> <img src="http://upload-images.jianshu.io/upload_images/7054861-3072fdcbae1ddd58.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="屏幕快照 2018-01-06 下午5.58.08.png"></p>
</li>
<li><p>在src中新建包，我这里是xyz.wyy.order.service,里面新建接口和实现类。（暂时忽略其他包）</p>
<p> <img src="http://upload-images.jianshu.io/upload_images/7054861-0dd53c35b4a3f73f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="屏幕快照 2018-01-06 下午6.02.46.png"></p>
</li>
<li><p>接口添加<code>@remote</code>注解，实现类添加<code>@stateless</code>注解<br> <img src="http://upload-images.jianshu.io/upload_images/7054861-5143929974774016.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="屏幕快照 2018-01-06 下午6.04.47.png"></p>
<p> <img src="http://upload-images.jianshu.io/upload_images/7054861-4700eeacb162cdf0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="屏幕快照 2018-01-06 下午6.04.57.png"></p>
</li>
<li><p>选择<code>edit configrations</code>配置运行，部署到wildfly。在<code>deployment</code>选项卡中，添加生成的war包。<br> <img src="http://upload-images.jianshu.io/upload_images/7054861-302466015ecf83e2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="屏幕快照 2018-01-06 下午6.15.44.png"></p>
</li>
<li><p>如果要链接数据库，还需要添加mysql-connector.jar的依赖。</p>
</li>
</ol>
<h2 id="创建客户端模块"><a href="#创建客户端模块" class="headerlink" title="创建客户端模块"></a>创建客户端模块</h2><ol>
<li>在已有的项目中新建模块 web application。</li>
<li>从解压缩的wildfly的 <code>bin/client</code>中拷贝出<code>jboss-client.jar</code>文件，复制到项目lib文件里（在src同级目录中新建lib文件夹），并右击jar包，点击<code>add to classpath</code>。</li>
<li><p>点击<code>file</code>-&gt;<code>Project Structure</code>，在artifacts中，client端的war包新建WEB-INF新建lib文件夹，将ejb的jar包添加进去（刚刚的ejb端已经下载好了，在右侧找ejb，双击就可以），如果jboss-client没有出现在lib里，也将jboss-client添加进去。</p>
<p> <img src="http://upload-images.jianshu.io/upload_images/7054861-509ac6183935c51c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="屏幕快照 2018-01-06 下午5.26.19.png"></p>
</li>
<li><p>新建包xyz.wyy.order.service 将接口拷贝过来，注意这里包的名字必须一样才可以。<strong>只需要拷贝接口。</strong> </p>
</li>
<li><p>新建xyz.wyy.order.factory包，新建<code>EJBFactory.java</code></p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EJBFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> Object <span class="title">getEJB</span><span class="params">(String path)</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            Properties jndiProps = <span class="keyword">new</span> Properties();</span><br><span class="line">            jndiProps.put(Context.URL_PKG_PREFIXES,<span class="string">"org.jboss.ejb.client.naming"</span>);</span><br><span class="line">            jndiProps.put(<span class="string">"jboss.naming.client.ejb.context"</span>, <span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">final</span> Context context = <span class="keyword">new</span> InitialContext(jndiProps);</span><br><span class="line">            <span class="keyword">return</span> context.lookup(path);</span><br><span class="line">        &#125;<span class="keyword">catch</span> (NamingException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<ol>
<li><p>在src目录下新建<code>jboss-ejb-client.properties</code>，并将一下内容拷贝进去。注意替换。</p>
 <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">endpoint.name=client-endpoint</span><br><span class="line">remote.connectionprovider.create.options.org.xnio.Options.SSL_ENABLED=false</span><br><span class="line">remote.connections=default</span><br><span class="line">remote.connection.default.host=localhost</span><br><span class="line">remote.connection.default.port=8080</span><br><span class="line">remote.connection.default.connect.options.org.xnio.Options.SASL_POLICY_NOANONYMOUS=false</span><br><span class="line">remote.connection.two.host=localhost</span><br><span class="line">remote.connection.two.port=8080</span><br><span class="line">remote.connection.two.connect.options.org.xnio.Options.SASL_POLICY_NOANONYMOUS=false</span><br><span class="line">remote.connection.default.username=你的wildfly用户名</span><br><span class="line">remote.connection.default.password=你的wildfly密码</span><br></pre></td></tr></table></figure>
</li>
<li><p>客户端通过EJBFactory获取接口，强制转换为指定接口，调用方法。比如</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">HelloWorld hello = (HelloWorld) EJBFactory.getEJB(</span><br><span class="line">              <span class="string">"ejb:/HelloWorldEJB_war_exploded/HelloWorldEJB!edu.nju.session.stateless.HelloWorld"</span></span><br><span class="line">      );</span><br></pre></td></tr></table></figure>
</li>
</ol>
<pre><code>jndi路径解析见下面。
</code></pre><ol>
<li>部署运行。</li>
</ol>
<h2 id="配置数据源（参考这里）"><a href="#配置数据源（参考这里）" class="headerlink" title="配置数据源（参考这里）"></a>配置数据源（参考<a href="http://blog.csdn.net/kylinsoong/article/details/17042245" target="_blank" rel="noopener">这里</a>）</h2><ol>
<li><p>添加Mysql数据库驱动模块到wildfly</p>
<p> 在wildfly/modules/system/layer/base/com目录下创建mysql/main目录，将Mysql驱动jar（例如mysql-connector-java-5.1.6.jar）拷贝到此目录下，并同在此目录下创建module.xml文件，添加内容如下：</p>
 <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;  </span><br><span class="line"><span class="tag">&lt;<span class="name">module</span> <span class="attr">xmlns</span>=<span class="string">"urn:jboss:module:1.1"</span> <span class="attr">name</span>=<span class="string">"com.mysql"</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">resources</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">resource-root</span> <span class="attr">path</span>=<span class="string">"mysql-connector-java-5.1.6.jar"</span>/&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">resources</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">"javax.api"</span>/&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">"javax.transaction.api"</span>/&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意这里的<code>rn:jboss:module:1.1</code>具体是什么版本，需要你看看同级目录其他模块用的版本号。</p>
</blockquote>
</li>
<li><p>添加驱动配置到wildfly服务器配置文件</p>
<p> 编辑wildfly/standalone/configuration/standalone.xml文件，在&lt;subsystem xmlns=”urn:jboss:domain:datasources处datasources，drivers中添加如下内容：</p>
 <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">	<span class="tag">&lt;<span class="name">driver</span> <span class="attr">name</span>=<span class="string">"mysql"</span> <span class="attr">module</span>=<span class="string">"com.mysql"</span>&gt;</span>     </span><br><span class="line">	    <span class="tag">&lt;<span class="name">xa-datasource-class</span>&gt;</span>com.mysql.jdbc.jdbc2.optional.MysqlXADataSource<span class="tag">&lt;/<span class="name">xa-datasource-class</span>&gt;</span>  </span><br><span class="line">	<span class="tag">&lt;/<span class="name">driver</span>&gt;</span> </span><br><span class="line">	``` </span><br><span class="line">3. 配置数据源</span><br><span class="line"></span><br><span class="line">	编辑wildfly/standalone/configuration/standalone.xml文件，在<span class="tag">&lt;<span class="name">subsystem</span> <span class="attr">xmlns</span>=<span class="string">"urn:jboss:domain:datasources处datasources中添加mysql数据源，如下：</span></span></span><br><span class="line"><span class="tag"><span class="string"></span></span></span><br><span class="line"><span class="tag"><span class="string">	```xml</span></span></span><br><span class="line"><span class="tag"><span class="string">	&lt;datasource jndi-name="</span><span class="attr">java:</span>/<span class="attr">mysqlDS</span>" <span class="attr">pool-name</span>=<span class="string">"mysqlDSPool"</span>&gt;</span>    </span><br><span class="line">	      <span class="tag">&lt;<span class="name">connection-url</span>&gt;</span>jdbc:mysql://localhost:3306/jbossdb<span class="tag">&lt;/<span class="name">connection-url</span>&gt;</span>    </span><br><span class="line">	      <span class="tag">&lt;<span class="name">driver</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">driver</span>&gt;</span>    </span><br><span class="line">	      <span class="tag">&lt;<span class="name">security</span>&gt;</span>    </span><br><span class="line">	         <span class="tag">&lt;<span class="name">user-name</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">user-name</span>&gt;</span>    </span><br><span class="line">	         <span class="tag">&lt;<span class="name">password</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">password</span>&gt;</span>    </span><br><span class="line">	      <span class="tag">&lt;/<span class="name">security</span>&gt;</span>    </span><br><span class="line">	<span class="tag">&lt;/<span class="name">datasource</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>至此，JBoss 7/WildFly中配置使用Mysql数据库完成。</p>
<p>项目中使用的代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    Context c = <span class="keyword">new</span> InitialContext();               <span class="comment">//初始化数据源</span></span><br><span class="line">    dataSource = (DataSource) c.lookup(<span class="string">"java:/mysqlDS"</span>);</span><br><span class="line">&#125; <span class="keyword">catch</span> (NamingException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h2><h3 id="1-artifact-‘XXXX-war-exploded’-has-invalid-extension"><a href="#1-artifact-‘XXXX-war-exploded’-has-invalid-extension" class="headerlink" title="1. artifact ‘XXXX:war exploded’ has invalid extension"></a>1. artifact ‘XXXX:war exploded’ has invalid extension</h3><p>一开始新建工程只选择了ejb工程，运行的时候报了这个错。在stackoverflow上的解决<a href="https://stackoverflow.com/questions/24725644/intellij-idea-artifact-xxxxwar-exploded-has-invalid-extension" target="_blank" rel="noopener">方案</a>试了一下，并不能解决问题。索性重新新建了一个module，勾选了ejb和web application，就运行正常了，也不知道什么原因。</p>
<h3 id="2-找不到ejb对象。"><a href="#2-找不到ejb对象。" class="headerlink" title="2. 找不到ejb对象。"></a>2. 找不到ejb对象。</h3><p>一般这种问题都是jndi路径的问题，我的路径为<code>ejb:/version3EJB_war_exploded/HelloWorldEJB!xyz.wyy.order.service.HelloWorld</code>。需要解释一下，<code>ejb:/</code>是ejb固定的命名空间，<code>version3EJB_war_exploded</code>是ejb项目的名字，这个名字是编译部署上wildfly的名字，需要查看out文件夹查看才算准确，默认不一定是就是你取的项目名字，<code>HelloWorldEJB</code>是你注解name的ejb名字，不是bean的类名，<code>xyz.wyy.order.service.HelloWorld</code>是实现类的完整路径。</p>
<p>当然其实在成功部署到wildfly之后，就会看输出信息，直接copy就可以了，也省的你麻烦，比如我的，部署后，有这么一段输出，第一个稍微变一变就是jndi路径了。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/7054861-4e940cce92b1d827.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="屏幕快照 2018-01-05 下午8.24.48.png"></p>
<h3 id="3-错误-Name-ejb-is-not-bound-in-this-Context-Unable-to-find-ejb-with-root-cause-javax-naming-NameNotFoundException-in-Wildfly"><a href="#3-错误-Name-ejb-is-not-bound-in-this-Context-Unable-to-find-ejb-with-root-cause-javax-naming-NameNotFoundException-in-Wildfly" class="headerlink" title="3. 错误 Name [ejb:..] is not bound in this Context. Unable to find [ejb:] with root cause javax.naming.NameNotFoundException in Wildfly"></a>3. 错误 Name [ejb:..] is not bound in this Context. Unable to find [ejb:] with root cause javax.naming.NameNotFoundException in Wildfly</h3><p>出现这个错误的时候，首先要检查你的路径是否写正确，参照第二个问题。其次，<strong>看看<code>jboss-client.jar</code>是否真的加入到了项目的依赖。</strong> 在idea中，简单将jar包复制到你新建的lib目录是不行的，点击<code>file</code>-&gt;<code>Project Structure</code></p>
<p><img src="http://upload-images.jianshu.io/upload_images/7054861-509ac6183935c51c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="屏幕快照 2018-01-06 下午5.26.19.png"></p>
<p>这里有的lib才是真正已经添加到项目中，能够使用，否则运行的时候会找不到jar。添加的方法是从右侧<code>Available Element</code>中双击指定的jar包，添加到war输出到war中。（如果右侧没有你的jar包，在你复制过来的jar包上右击，选择<code>add to classpath</code>）</p>
<h3 id="4-配置wildfly数据源的时候，每次配置完，重新部署wildfly，之前在standalone-xml中添加的配置被重置到初始状态。"><a href="#4-配置wildfly数据源的时候，每次配置完，重新部署wildfly，之前在standalone-xml中添加的配置被重置到初始状态。" class="headerlink" title="4. 配置wildfly数据源的时候，每次配置完，重新部署wildfly，之前在standalone.xml中添加的配置被重置到初始状态。"></a>4. 配置wildfly数据源的时候，每次配置完，重新部署wildfly，之前在<code>standalone.xml</code>中添加的配置被重置到初始状态。</h3><p>经历了无数尝试。。发现必须先把wildfly关闭再去配置，否咋配置完再重启，数据都会被重置为上次运行的状态。。</p>
<h4 id="5-客户端运行的时候，EJB端调用数据库的方法处报错。javax-naming-NameNotFoundException-找不到数据源。"><a href="#5-客户端运行的时候，EJB端调用数据库的方法处报错。javax-naming-NameNotFoundException-找不到数据源。" class="headerlink" title="5. 客户端运行的时候，EJB端调用数据库的方法处报错。javax.naming.NameNotFoundException 找不到数据源。"></a>5. 客户端运行的时候，EJB端调用数据库的方法处报错。javax.naming.NameNotFoundException 找不到数据源。</h4><p>！！要检查配置数据源的步骤有没有按着做！！每一步都不能少！！</p>
<p>我出现这个问题，找了半天bug，最后在wildfly的输出中找到了这个</p>
<p><img src="http://upload-images.jianshu.io/upload_images/7054861-401dc860a846391d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="屏幕快照 2018-01-06 下午5.31.52.png"></p>
<p>显然是数据源没有配置好，找不到mysql驱动。去检查一下驱动的配置，f<strong><em>**</em></strong>k，把mysql写成了myql，路径不对。。吐血。</p>
<p>所以配置数据源的时候一定要谨慎，<strong>遇到问题，一定不要忘记看完整的log输出</strong></p>

      
    </div>
    <div class="article-footer">
      <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>本文链接：</strong>
      <a href="http://imwyy.github.io/2018/01/05/idea使用wildfly创建ejb项目/" title="idea使用wildfly创建ejb项目" target="_blank" rel="external">http://imwyy.github.io/2018/01/05/idea使用wildfly创建ejb项目/</a>
    </li>
    
    <li class="post-copyright-license">
      <strong>版权声明： </strong> 本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！
    </li>
  </ul>
</blockquote>


<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="https://github.com/IMWYY" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="/images/head.jpg" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="https://github.com/IMWYY" target="_blank"><span class="text-dark">stephen</span><small class="ml-1x">What The f__k</small></a></h3>
        <div>我真的不会码代码。</div>
      </div>
    </figure>
  </div>
</div>


    </div>
  </article>
  
    
  <section id="comments">
  	
       
    <div id="uyan_frame"></div>

    
  </section>


  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    <li class="prev">
      <a href="/2018/01/11/idea使用hibernate5/" title="idea使用hibernate5"><i class="fa fa-angle-left" aria-hidden="true"></i>&nbsp;&nbsp;Newer</a>
    </li>
    
    
    <li class="next">
      <a href="/2018/01/04/android图片文件优化/" title="android图片文件优化">Older&nbsp;&nbsp;<i class="fa fa-angle-right" aria-hidden="true"></i></a>
    </li>
    
  </ul>
  
  
  <!-- Button trigger modal -->
  <button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning hidden-xs" data-toggle="modal" data-target="#donateModal"><span>$</span></button>
  
  
  <div class="bar-right">
    <div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter" data-mobile-sites="weibo,qq,qzone"></div>
  </div>
  
  </div>
</nav>
  
<!-- Modal -->
<div class="modal modal-center modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      <div class="modal-body">
        <div class="donate-box">
          <div class="donate-tit">
            <p>Thank you for your support, I will continue to work hard!</p>
          </div>
          <div class="donate-payimg">
            <img src="/images/donate/alipayimg.png" alt="Scan Qrcode" title="Scan" />
          </div>
          <p class="text-muted mv">Scan this qrcode</p>
          <div class="donate-payselect">
            <div class="pay_item checked" data-id="alipay" data-src="/images/donate/alipayimg.png">
              <div class="radio">
                <input type="radio" name="payment" id="input-alipay" value="alipay" checked>
                <label class="pay_logo clickable" for="input-alipay"><img src="/images/donate/alipay.jpg" alt="alipay" /></label>
              </div>
            </div>
            <div class="pay_item" data-id="weipay" data-src="/images/donate/weipayimg.png">
              <div class="radio">
                <input type="radio" name="payment" id="input-weipay" value="weipay">
                <label class="pay_logo clickable" for="input-weipay"><img src="/images/donate/weipay.jpg" alt="weipay" /></label>
              </div>
            </div>
          </div>
          <div class="text-grey">
            <p>Scan this qrcode, you can sweep yards reward oh!</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>



</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
	
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/IMWYY" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="fa fa-github"></i></a></li>
        
    </ul>

    <div class="copyright">
    	
    </div>
</footer>
  <script src="https://cdn.bootcss.com/jquery/1.12.4/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>
<script src="/js/plugin.js"></script>
<script src="/js/application.js"></script>
  
    
    
    
        <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>
    
    
    
        
<script defer src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



    
    
        
    
    <script defer type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=[object Object]"></script>


    
    



</body>
</html>